# 2048 Game

_while_ ← {F‿G←𝔽‿𝔾 ⋄ {𝕊⍟G F 𝕩}}
_retry_ ← {F‿G←𝔽‿𝔾 ⋄ {G◶⟨𝕊𝕩˙, ⊢⟩F𝕩}}
GetInput ← {{•←𝕩}¨¯1↓𝕩 ⋄ •←c←⊑¯1↑𝕩 ⋄ ⊑ •Stdin _retry_ (⊑∘∊⟜c) 1}

Game ← {
  Move ← {
    ⟨L,R,U,D⟩ ← {L⇐⊢ ⋄ R⇐{𝕊:⌽˘𝕩;𝕊⁼:𝕊𝕩} ⋄ U⇐⍉ ⋄ D⇐R⍉}
    C ← ×⟜(∾·(≠⊸⥊⟜1‿0∧1+«⊸=)¨(+`∘»«⊸≠)⊸⊔)
    S ← ≠↑⊢⊏˜·/1⊸⌊
    S∘C∘S⎉1⌾(⍎GetInput⟨𝕩, "Enter move:", "l"‿"r"‿"u"‿"d"⟩) 𝕩
  }
  SpawnTile ← {(2+2×2=•Rand 10)⌾((•Rand∘≠⊸⊑/0=𝕩)⊸⊏)𝕩}⌾⥊
  Turn ← SpawnTile∘{b←𝕩 ⋄ Move _retry_ (≢⟜b) 𝕩}

  board ← SpawnTile∘{𝕩‿𝕩⥊0} ⍎GetInput⟨"Enter Board Size:", "4"‿"5"‿"6"⟩
  𝕤 ⋄ Turn _while_ (¬2048⊸∊) board
 }

 •←Game @
