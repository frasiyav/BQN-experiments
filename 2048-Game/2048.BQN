# 2048 Game

GetInput ← {{•←𝕩}¨¯1↓𝕩 ⋄ •←c←⊑¯1↑𝕩 ⋄ ⊑∘∊⟜c◶⟨𝕨𝕊𝕩˙, ⊑⟩ •Stdin 1}
_while_ ← {F‿G←𝔽‿𝔾 ⋄ {𝕊⍟G F 𝕩}}

Game ← {
  Move ← {
    ⟨L,R,U,D⟩ ← {L⇐⊢ ⋄ R⇐{𝕊:⌽˘𝕩;𝕊⁼:𝕊𝕩} ⋄ U⇐⍉ ⋄ D⇐R⍉}
    C ← ×⟜(∾·(≠⊸⥊⟜1‿0∧1+«⊸=)¨(+`∘»«⊸≠)⊸⊔)
    S ← ≠↑⊢⊏˜·/1⊸⌊
    S∘C∘S⎉1⌾(⍎GetInput⟨𝕩, "Enter move:", "l"‿"r"‿"u"‿"d"⟩) 𝕩
  }
  SpawnTile ← {2⌾((•Rand∘≠⊸⊑/0=𝕩)⊸⊏)𝕩}⌾⥊
  Turn ← SpawnTile∘{≡⟜𝕩◶⟨⊢, 𝕊𝕩˙⟩ Move 𝕩}

  board ← SpawnTile∘{𝕩‿𝕩⥊0} ⍎GetInput⟨"Enter Board Size:", "4"‿"5"‿"6"⟩
  𝕤 ⋄ Turn _while_ (¬2048⊸∊) board
 }

 •←Game @
